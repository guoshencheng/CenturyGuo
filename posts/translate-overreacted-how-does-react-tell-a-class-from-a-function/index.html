<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style>
/* latin */
@font-face {
  font-family: 'Press Start 2P';
  font-style: normal;
  font-weight: 400;
  src: local('Press Start 2P Regular'), local('PressStart2P-Regular'), url('/static/PressStart2P-Regular.01515575.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215;
}
html {
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
}
</style><link rel="preload" href="/component---src-layouts-index-js-5fa57a956833cc6431c9.js" as="script"/><link rel="preload" href="/component---src-templates-post-js-151fda6e99914a23c475.js" as="script"/><link rel="preload" href="/path---posts-translate-overreacted-how-does-react-tell-a-class-from-a-function-1605e86aeffe6e303109.js" as="script"/><link rel="preload" href="/app-3753e803ea1a9abe3edc.js" as="script"/><link rel="preload" href="/commons-cf32f37b11eea4693204.js" as="script"/><title data-react-helmet="true">Century&#x27;s world</title><meta data-react-helmet="true" name="description" content="Sample"/><meta data-react-helmet="true" name="keywords" content="sample, something"/><style id="gatsby-inlined-css">.header{font-size:15px;height:50px;overflow:hidden;line-height:50px;box-sizing:border-box;width:100%;padding:0 30px}.header a{color:inherit;text-decoration:none}.header .header-title-container{float:left}.header .header-line-item{font-size:13px;float:right}.markdown-body{color:#4c4c4c;overflow:hidden;font-family:Helvetica Neue,Helvetica,Segoe UI,Arial,freesans,sans-serif;font-size:15px;line-height:1.6;word-wrap:break-word}.markdown-body a{background:transparent}.markdown-body a:active,.markdown-body a:hover{outline:0}.markdown-body strong{font-weight:700}.markdown-body h1{font-size:2em;margin:.67em 0}.markdown-body img{border:0}.markdown-body hr{box-sizing:content-box}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body input{color:inherit;font:inherit;margin:0}.markdown-body html input[disabled]{cursor:default}.markdown-body input{line-height:normal}.markdown-body input[type=checkbox]{box-sizing:border-box;padding:0}.markdown-body table{border-collapse:collapse;border-spacing:0}.markdown-body td,.markdown-body th{padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font:13px/1.4 Helvetica,arial,freesans,clean,sans-serif}.markdown-body a{color:#4183c4;text-decoration:none}.markdown-body a:active,.markdown-body a:focus,.markdown-body a:hover{text-decoration:underline}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border:0;border-bottom:1px solid #ddd}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:15px;margin-bottom:15px;line-height:1.1}.markdown-body h1{font-size:30px}.markdown-body h2{font-size:21px}.markdown-body h3{font-size:16px}.markdown-body h4{font-size:14px}.markdown-body h5{font-size:12px}.markdown-body h6{font-size:11px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code{font-family:monospace,monospace,source-code-pro,Menlo,Monaco,Consolas,Courier New;font-size:13px;border-radius:8px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body kbd{background-color:#e7e7e7;background-image:linear-gradient(#fefefe,#e7e7e7);background-repeat:repeat-x;border-radius:2px;border:1px solid #cfcfcf;color:#000;padding:3px 5px;line-height:10px;font:11px Consolas,Liberation Mono,Menlo,Courier,monospace;display:inline-block}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body .anchor{position:absolute;top:0;bottom:0;left:0;display:block;padding-right:6px;padding-left:30px;margin-left:-30px}.markdown-body .anchor:focus{outline:none}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:1em;margin-bottom:16px;font-weight:700;line-height:1.4}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{display:none;color:#000;vertical-align:middle}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{height:1em;padding-left:8px;margin-left:-30px;line-height:1;text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{display:inline-block}.markdown-body h1{font-size:2.25em;line-height:1.2}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.75em;line-height:1.225}.markdown-body h3{font-size:1.5em;line-height:1.43}.markdown-body h4{font-size:1.25em}.markdown-body h5{font-size:1em}.markdown-body h6{font-size:1em;color:#777}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:4px;padding:0;margin:16px 0;background-color:#e7e7e7;border:0 none}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body blockquote{padding:0 15px;color:#777;border-left:4px solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:border-box}.markdown-body code:after,.markdown-body code:before{letter-spacing:-.2em;content:"\A0"}.markdown-body pre>code{font-size:14px;word-break:normal;white-space:pre;border:0;max-height:200px}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body pre{word-wrap:normal}.markdown-body pre code{word-wrap:normal;border:0}.markdown-body pre code:after,.markdown-body pre code:before{content:normal}.markdown-body .highlight .il,.markdown-body .highlight .m,.markdown-body .highlight .mf,.markdown-body .highlight .mh,.markdown-body .highlight .mi,.markdown-body .highlight .mo{color:#945277}.markdown-body .highlight .s,.markdown-body .highlight .s1,.markdown-body .highlight .s2,.markdown-body .highlight .sb,.markdown-body .highlight .sc,.markdown-body .highlight .sd,.markdown-body .highlight .se,.markdown-body .highlight .sh,.markdown-body .highlight .si,.markdown-body .highlight .sx{color:#df5000}.markdown-body .highlight .k,.markdown-body .highlight .kc,.markdown-body .highlight .kd,.markdown-body .highlight .kn,.markdown-body .highlight .kp,.markdown-body .highlight .kr,.markdown-body .highlight .kt,.markdown-body .highlight .o{font-weight:700}.markdown-body .highlight .kt{color:#458}.markdown-body .highlight .c,.markdown-body .highlight .c1,.markdown-body .highlight .cm{color:#998;font-style:italic}.markdown-body .highlight .cp,.markdown-body .highlight .cs{color:#999;font-weight:700}.markdown-body .highlight .cs{font-style:italic}.markdown-body .highlight .n{color:#4c4c4c}.markdown-body .highlight .na,.markdown-body .highlight .nv,.markdown-body .highlight .vc,.markdown-body .highlight .vg,.markdown-body .highlight .vi{color:teal}.markdown-body .highlight .nb{color:#0086b3}.markdown-body .highlight .nc{color:#458;font-weight:700}.markdown-body .highlight .no{color:#094e99}.markdown-body .highlight .ni{color:purple}.markdown-body .highlight .ne{color:#900;font-weight:700}.markdown-body .highlight .nf{color:#945277;font-weight:700}.markdown-body .highlight .nn{color:#555}.markdown-body .highlight .nt{color:navy}.markdown-body .highlight .err{color:#a61717;background-color:#e3d2d2}.markdown-body .highlight .gd{color:#000;background-color:#fdd}.markdown-body .highlight .gd .x{color:#000;background-color:#faa}.markdown-body .highlight .ge{font-style:italic}.markdown-body .highlight .gr{color:#a00}.markdown-body .highlight .gh{color:#999}.markdown-body .highlight .gi{color:#000;background-color:#dfd}.markdown-body .highlight .gi .x{color:#000;background-color:#afa}.markdown-body .highlight .go{color:#888}.markdown-body .highlight .gp{color:#555}.markdown-body .highlight .gs{font-weight:700}.markdown-body .highlight .gu{color:purple;font-weight:700}.markdown-body .highlight .gt{color:#a00}.markdown-body .highlight .ow{font-weight:700}.markdown-body .highlight .w{color:#bbb}.markdown-body .highlight .sr{color:#017936}.markdown-body .highlight .ss{color:#8b467f}.markdown-body .highlight .bp{color:#999}.markdown-body .highlight .gc{color:#999;background-color:#eaf2f5}.markdown-body .octicon{font:normal normal 16px octicons-anchor;line-height:1;display:inline-block;text-decoration:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .octicon-link:before{content:"\F05C"}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{float:left;margin:.3em 0 .25em -1.6em;vertical-align:middle}html{top:0;position:fixed}body,html{width:100%;height:100%}body{position:absolute;margin:0;font-family:-apple-system,Helvetica Neue,Helvetica,Segoe UI,Arial,freesans,sans-serif;color:#373737}.indie-flow-text{font-family:Indie Flower,Helvetica Neue}.game-text{font-family:Press Start\ 2P,Helvetica Neue}.container{position:absolute;width:100%;bottom:0;left:0;top:0;overflow:auto;-webkit-overflow-scrolling:touch}.container.with-header{top:50px}.posts-list{margin:20px auto;max-width:1000px;padding:0 40px}.posts-list .post-item{margin-bottom:30px}.posts-list .post-item .post-item-title{line-height:40px;font-size:28px}.posts-list .post-item .post-item-title a{color:inherit;text-decoration:none}.posts-list .post-item .post-item-base-info{line-height:30px;color:#afbd20;font-size:13px}.posts-list .post-item .post-item-desc{font-size:15px}.post-container{max-width:1000px;margin:0 auto;padding:0 20px}.post-container .post-title{font-size:30px}.post-container .post-date{margin-left:10px;color:#afbd20}.post-container .post-tag{color:rgba(82,162,96,.6)}.post-container .post-tag a{margin-left:10px;color:inherit;text-decoration:none}.post-container .post-tag a:hover{color:#52a260}.post-container .markdown-body{margin-top:30px}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}.mashroom-item{border-radius:5px;margin:.5px;float:left;width:40px;height:40px;background-color:rgba(253,209,14,.6);animation:rotateplane 10s infinite ease-in-out}.mashroom-item.deep{background-color:rgba(253,209,14,.7)}.mashroom-item.blank{animation:none;background:none}@keyframes rotateplane{0%{transform:perspective(120px) rotateX(0deg) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(0deg) rotateY(0deg)}10%{transform:perspective(120px) rotateX(-180.1deg) rotateY(0);-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0)}50%{transform:perspective(120px) rotateX(-180.1deg) rotateY(0);-webkit-transform:perspective(120px) rotateX(-180.1deg) rotateY(0)}60%{transform:perspective(120px) rotateX(-1turn) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(-1turn) rotateY(0deg)}to{transform:perspective(120px) rotateX(-1turn) rotateY(0deg);-webkit-transform:perspective(120px) rotateX(-1turn) rotateY(0deg)}}.home-page-container{background:#52a260;position:absolute;left:0;top:0;width:100%;height:100%}.home-page{text-align:center;color:#fff;box-sizing:border-box;overflow:hidden}.home-page .home-title{font-size:35px;margin-bottom:50px}.home-page .mashroom-container{width:328px;margin:0 auto;position:relative;overflow:hidden}.home-page .operations{margin-top:30px}.home-page .operations a{color:#fff;text-decoration:none;margin:0 20px}</style></head><body><div id="___gatsby"><div data-reactroot=""><div class="header"><div class="header-title-container"><div class="header-logo"></div><div class="header-title game-text"><a href="/">Century&#x27;s world</a></div></div><div class="header-line-item game-text header-link"><a href="/">Posts</a></div></div><div class="container with-header"><div class="post-container"><div class="post-title">ç¿»è¯‘ï¼šReactæ˜¯å¦‚ä½•å°†Functionè½¬å˜æˆç±»çš„</div><div class="extra-info"><span class="post-date">02 December, 2018</span><span class="post-tag"><a href="/posts/translate">translate</a><a href="/posts/overreacted">overreacted</a></span></div><div class="markdown-body"><div><blockquote>
<p>æœ¬æ–‡å‡ºè‡ª<a href="https://overreacted.io/">overreacted</a>ï¼Œè¿™æ˜¯<a href="https://mobile.twitter.com/dan_abramov">Dan Abramov</a>å†™çš„åšå®¢ï¼Œæˆ‘è§‰å¾—å¯¹å¾ˆæœ‰ç”¨æ‰€ä»¥ç‰¹æ„åšäº†è¿™ä¸ªç¿»è¯‘<a href="/posts/overreacted">ç³»åˆ—</a>ï¼ŒåŸæ–‡é“¾æ¥è¯·æŸ¥çœ‹<a href="https://overreacted.io/how-does-react-tell-a-class-from-a-function/">è¿™é‡Œ</a></p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªç”¨å‡½æ•°å®šä¹‰çš„<code class="language-text">Greeting</code>ç»„ä»¶:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>Reactä¹Ÿæ”¯æŒå°†è¿™ä¸ªç»„ä»¶å®šä¹‰æˆä¸€ä¸ªç±»:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>(æˆ‘ä»¬åªèƒ½ä½¿ç”¨ç±»çš„å®šä¹‰çš„æ–¹å¼æ¥ä½¿ç”¨ä¸€äº›ç±»ä¼¼äºstateè¿™æ ·çš„åŠŸèƒ½ï¼ŒçŸ¥é“æœ€è¿‘çš„<a href="https://reactjs.org/docs/hooks-intro.html">hooks</a>)</p>
<p>å½“ä½ æƒ³è¦æ¸²æŸ“<code class="language-text">&lt;Greeting /&gt;</code>æ—¶ï¼Œä½ ä¸ç”¨å…³ç³»å®ƒç©¶ç«Ÿæ˜¯å¦‚ä½•å®šä¹‰çš„:</p>
<div class="gatsby-highlight" data-language="jsx">
      <pre class="language-jsx"><code class="language-jsx"><span class="token comment">// æ— è®ºæ˜¯å‡½æ•°å®šä¹‰è¿˜æ˜¯ç±»å®šä¹‰</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Greeting</span> <span class="token punctuation">/></span></span></code></pre>
      </div>
<p>ä½†æ˜¯ <em>React è‡ªå·±</em> ä¼šå…³å¿ƒè¿™ä¸¤ç§å®šä¹‰æ–¹å¼çš„åŒºåˆ«</p>
<p>å¦‚æœ<code class="language-text">Greeting</code>æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒReactä¼šç›´æ¥è°ƒç”¨å®ƒ:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// ä½ çš„ä»£ç </span>
<span class="token keyword">function</span> <span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Reactå†…éƒ¨çš„å®ç°</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">Greeting</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;p>Hello&lt;/p></span></code></pre>
      </div>
<p>ä½†æ˜¯å¦‚æœ<code class="language-text">Greeting</code>æ˜¯ä¸€ä¸ªç±»ï¼ŒReactéœ€è¦å…ˆè¯•ç”¨<code class="language-text">new</code>æ¥å®ä¾‹åŒ–å®ƒï¼Œç„¶ååœ¨è°ƒç”¨å®ƒçš„<code class="language-text">render</code>å‡½æ•°:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// ä½ çš„ä»£ç </span>
<span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Reactå†…éƒ¨å®ç°</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Greeting {}</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> instance<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;p>Hello&lt;/p></span></code></pre>
      </div>
<p>åœ¨ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­ä¸­ï¼ŒReactçš„ç›®æ ‡éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå°±æ˜¯å°†ä½ éœ€è¦æ¸²æŸ“çš„ReactèŠ‚ç‚¹è·å–åˆ°ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ˜¯<code class="language-text">&lt;p&gt;Hellp&lt;/p&gt;</code>ï¼‰ã€‚ä½†æ˜¯è¿™äº›é¢å¤–çš„æ“ä½œå–å†³äº<code class="language-text">Greeting</code>æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚</p>
<p><strong>é‚£ä¹ˆReactæ˜¯å¦‚ä½•çŸ¥é“è¿™ä¸ªç»„ä»¶æ˜¯ä½¿ç”¨å‡½æ•°å®šä¹‰çš„è¿˜æ˜¯ç±»å®šä¹‰çš„å‘¢ï¼Ÿ</strong></p>
<p>å°±æƒ³æˆ‘<a href="/posts/translate-overreacted-why-do-we-write-super-props">ä¹‹å‰çš„æ–‡ç« </a>è®²çš„é‚£æ ·ï¼Œ<strong>å¯¹äºä½¿ç”¨Reactçš„æ—¶å€™ï¼Œä½ å¹¶ä¸<em>éœ€è¦</em>äº†è§£è¿™äº›</strong> å¾ˆå¤šå¹´é‡Œï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¿™äº›ã€‚æ‰€ä»¥è¯·ä¸è¦å°†è¿™äº›ä½œä¸ºä½ çš„é¢è¯•é¢˜ç›®ã€‚äº‹å®ä¸Šï¼Œè¿™ç¯‡æ–‡ç« æ›´å¤šçš„æ˜¯è®²è§£Javascriptè€Œä¸æ˜¯React</p>
<p>è¿™ç¯‡æ–‡ç« æ˜¯é’ˆå¯¹é‚£äº›æƒ³çŸ¥é“Reactç©¶ç«Ÿå¦‚ä½•å·¥ä½œçš„äººçš„ã€‚ä½ æ˜¯è¿™æ ·çš„äººä¹ˆï¼Ÿé‚£ä¹ˆè®©æˆ‘ä»¬ä¸€èµ·æ¥æ¢ç´¢å§ã€‚</p>
<p><strong>è¿™æ˜¯ä¸€ç¯‡éå¸¸é•¿çš„æ—…ç¨‹ã€‚ç³»å¥½å®‰å…¨å¸¦å§ï¼è¿™ç¯‡æ–‡ç« å¹¶ä¸ä¼šæœ‰å¤ªå¤šçš„å…³äºReactæœ¬èº«ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šæ¢ç´¢åˆ°ä¸€äº›æ¦‚å¿µï¼Œæ¯”å¦‚<code class="language-text">new</code>,<code class="language-text">this</code>,<code class="language-text">class</code>,<code class="language-text">arrow</code>,<code class="language-text">functions</code>,<code class="language-text">prototypela</code>, <code class="language-text">_proto_</code>,<code class="language-text">instanceof</code>,ä»¥åŠè¿™äº›ä¸œè¥¿åœ¨Javascriptä¸­æ˜¯å¦‚ä½•ä¸€èµ·å·¥ä½œçš„ã€‚éå¸¸å¹¸è¿çš„æ˜¯ï¼Œä½ åœ¨ä½¿ç”¨Reactçš„æ—¶å€™å¹¶ä¸éœ€è¦å¤ªè€ƒè™‘è¿™äº›ã€‚ä¸è¿‡å‡å¦‚ä½ åœ¨å®ç°Reactçš„è¯ï¼Œé‚£å°±ä¸ä¸€æ ·äº†...</strong></p>
<p>(å¦‚æœä½ çœŸçš„åªæ˜¯æƒ³çŸ¥é“æœ€ç»ˆçš„ç­”æ¡ˆçš„è¯ï¼Œå¯ä»¥ç›´æ¥æ»šåŠ¨åˆ°æœ€åº•ä¸‹)</p>
<hr>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä¸ºä»€ä¹ˆæœ‰å¿…è¦å»å¯¹å‡½æ•°çš„ç”³æ˜æ–¹å¼å’Œç±»çš„ç”³æ˜æ–¹å¼åŒºåˆ†ã€‚å¯ä»¥æ³¨æ„ä¸€ä¸‹æˆ‘ä»¬åœ¨ä½¿ç”¨ç±»çš„ç”³æ˜ç»„ä»¶çš„æ—¶å€™å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// å¦‚æœGreetingæ˜¯ä¸€ä¸ªå‡½æ•°</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">Greeting</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;p>Hello&lt;/p></span>

<span class="token comment">// å¦‚æœGreetingæ˜¯ä¸€ä¸ªç±»</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Greeting {}</span>
</span><span class="token keyword">const</span> result <span class="token operator">=</span> instance<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &lt;p>Hello&lt;/p></span></code></pre>
      </div>
<p>è®©æˆ‘ä»¬æ·±åº¦çš„æ¥äº†è§£ä¸€ä¸‹å½“ä½¿ç”¨<code class="language-text">new</code>çš„æ—¶å€™ï¼ŒJavascriptåšäº†ä»€ä¹ˆ</p>
<hr>
<p>åœ¨æ¯”è¾ƒæ—©çš„æ—¶å€™ï¼ŒJavascriptè¿˜æ²¡æœ‰å®šä¹‰ç±»çš„æ–¹å¼ã€‚ä½†æ˜¯ä½ å¯ä»¥é€šè¿‡çº¯å‡½æ•°æ¥æ¨¡æ‹Ÿå‡ºä¸€ä¸ªç±»çš„æ•ˆæœã€‚<strong>å…·ä½“çš„æ¥è¯´å°±æ˜¯ï¼Œé€šè¿‡å¯¹å‡½æ•°ä½¿ç”¨<code class="language-text">new</code>è°ƒç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨<em>ä»»ä½•</em>å‡½æ•°æ¥ä½œä¸ºä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°</strong>:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// è¿™åªæ˜¯ä¸€ä¸ªå‡½æ•°</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> fred <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Fred'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… Person {name: 'Fred'}</span>
<span class="token keyword">var</span> george <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">'George'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ”´ å¹¶ä¸èµ·ä½œç”¨</span></code></pre>
      </div>
<p>è¿™äº›ä»£ç ä¾ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä½ å¯ä»¥åœ¨å¼€å‘å·¥å…·ä¸­å°è¯•ã€‚</p>
<p>å¦‚æœä½ åœ¨è°ƒç”¨<code class="language-text">Person(&#39;Fred&#39;)</code>çš„æ—¶å€™<strong>ä¸ä½¿ç”¨</strong><code class="language-text">new</code>æ“ä½œç¬¦ï¼Œå‡½æ•°å†…çš„<code class="language-text">this</code>æŒ‡å‘å°±ä¼šæŒ‡å‘ä¸€äº›å…¨å±€æˆ–è€…æ²¡æœ‰ä»€ä¹ˆç”¨çš„å¯¹è±¡(æ¯”å¦‚è¯´ï¼Œ<code class="language-text">window</code>æˆ–è€…<code class="language-text">undefined</code>)ã€‚å¦‚æœè¿™ä¹ˆä½¿ç”¨çš„è¯ï¼Œæˆ‘ä»¬çš„ä»£ç å°±ä¼šæŠ¥é”™æˆ–è€…æ‰§è¡Œä¸€äº›è®¾ç½®<code class="language-text">window.name</code>ä¹‹ç±»çš„å‚»å…®å…®çš„äº‹æƒ…ã€‚</p>
<p>é€šè¿‡åœ¨è°ƒç”¨å‰æ·»åŠ <code class="language-text">new</code>çš„æ“ä½œç¬¦ã€‚æˆ‘ä»¬ç›¸å½“äºåœ¨è¯´: "Hey Javascriptï¼Œæˆ‘çŸ¥é“<code class="language-text">Person</code>æ˜¯ä¸€ä¸ªå‡½æ•°å•¦ï¼Œä½†æ˜¯å¯ä»¥ä¸å¯ä»¥è®©æˆ‘ä»¬å‡è£…å®ƒæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°"ã€‚<strong>åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œç„¶åè®©<code class="language-text">Person</code>å‡½æ•°ä¸­çš„<code class="language-text">this</code>æŒ‡å‘è¿™ä¸ªå¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿä¸ºè¿™ä¸ªå¯¹è±¡è®¾ç½®åƒ<code class="language-text">this.name</code>è¿™æ ·çš„æˆå‘˜å˜é‡ã€‚ç„¶åå°†è¿™ä¸ªå¯¹è±¡è¿”å›</strong></p>
<p>è¿™å°±æ˜¯<code class="language-text">new</code>è¿™ä¸ªæ“ä½œç¬¦åšçš„äº‹æƒ…</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">var</span> fred <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Fred'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è¿”å›æ„é€ å‡½æ•°ä¸­çš„this</span></code></pre>
      </div>
<p><code class="language-text">new</code>è¿™ä¸ªæ“ä½œä¹Ÿå°†<code class="language-text">Person.prototype</code>ä¸­çš„æˆå‘˜å˜é‡ä»£ç†åˆ°äº†<code class="language-text">fred</code>çš„å¯¹è±¡ä¸Š:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Hi, I am '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> fred <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Fred'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fred<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>è¿™å°±æ˜¯å¤§å®¶åœ¨Javascriptæ¨å‡ºç±»çš„å†™æ³•ä¹‹å‰æ¨¡æ‹Ÿå‡ºæ¥çš„ç±»</p>
<hr>
<p>æ‰€ä»¥<code class="language-text">new</code>åœ¨Javascriptä¸­å·²ç»å­˜åœ¨äº†å¾ˆé•¿æ—¶é—´äº†ï¼Œä½†æ˜¯ï¼Œclassesæ˜¯æœ€è¿‘å‡ å¹´æ‰æœ‰çš„ã€‚ä½¿ç”¨å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°ç¼–å†™æˆ‘ä»¬çš„ä»£ç ï¼Œè®©æˆ‘ä»¬ç¦»ä»Šå¤©è¦æ¢ç©¶çš„äº‹æƒ…æ›´åŠ è´´åˆ‡ã€‚</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Hi, I am '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> fred <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Fred'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fred<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p><em>æŠ“ä½å¼€å‘è€…æƒ³è¦çš„ä¸œè¥¿</em>åœ¨è®¾è®¡è¯­è¨€å’ŒAPIçš„æ—¶å€™æ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p>å¦‚æœä½ å†™äº†ä¸€ä¸ªå‡½æ•°ï¼ŒJavascriptä¸èƒ½å¤Ÿå®Œå…¨æ˜ç™½ç©¶ç«Ÿè€…æ„å‘³ç€æ˜¯åƒ<code class="language-text">alert()</code>è¿™æ ·ç›´æ¥è°ƒç”¨æˆ–è€…ä¼šåƒ<code class="language-text">new Person()</code>è¿™æ ·å½“åšä¸€ä¸ªæ„é€ å‡½æ•°æ¥è°ƒç”¨ã€‚å¦‚æœå¿˜è®°æ‰åœ¨åƒ<code class="language-text">Person</code>è¿™ç§å‡½æ•°å‰é¢åŠ ä¸Š<code class="language-text">new</code>æ“ä½œç¬¦ä¼šè®©ä»£ç å‡ºç°ä¸€äº›ç¥å¥‡çš„ç°è±¡ã€‚</p>
<p><strong>Classçš„é¢„å‘è®©æˆ‘ä»¬å‘Šè¯‰Javascriptçš„è¿è¡Œè€…: "è¿™ä¸æ˜¯åªæ˜¯ä¸€ä¸ªå‡½æ•° - è¿™æ˜¯ä¸€ä¸ªç±»ï¼Œä»–æœ‰ä¸€ä¸ªæ„é€ å‡½æ•°"</strong>ï¼Œå½“ä½ åœ¨è°ƒç”¨å®ƒçš„æ—¶å€™å¿˜è®°ä½¿ç”¨<code class="language-text">new</code>æ“ä½œç¬¦çš„æ—¶å€™ï¼ŒJavascriptä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">let</span> fred <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Fred'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// âœ… å¦‚æœPersonæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ²¡æœ‰é—®é¢˜</span>
<span class="token comment">// âœ… å¦‚æœPersonæ˜¯ä¸€ä¸ªç±»ï¼Œæ²¡æœ‰é—®é¢˜</span>

<span class="token keyword">let</span> george <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">'George'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æˆ‘ä»¬å¿˜è®°æ·»åŠ `new`</span>
<span class="token comment">// ğŸ˜³ å¦‚æœç”¨æˆ·æ˜¯ä¸€ä¸ªç±»ä¼¼æ„é€ å‡½æ•°çš„å‡½æ•° è¿™ä¸ªå‡½æ•°æ‰§è¡Œä¼šå‡ºç°ä¸€äº›å¥‡æ€ªçš„æƒ…å†µ</span>
<span class="token comment">// ğŸ”´ å¦‚æœPersonæ˜¯ä¸€ä¸ªç±»ï¼Œä¼šç«‹é©¬æŠ›å‡ºå¼‚å¸¸</span></code></pre>
      </div>
<p>è¿™è®©æˆ‘ä»¬åœ¨å‡ºç°ä¸€äº›ç±»ä¼¼äº<code class="language-text">this.name</code>è¢«èµ‹å€¼ä¸º<code class="language-text">window.name</code>è€Œä¸æ˜¯<code class="language-text">georage.name</code>çš„é—®é¢˜ä¹‹å‰å°±èƒ½å¤ŸåŠæ—©çš„å‘ç°é—®é¢˜ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™å°±ä»£è¡¨ç€Reactéœ€è¦åœ¨åˆ›å»ºç±»ä¹‹å‰åŠ ä¸Šä¸€ä¸ª<code class="language-text">new</code>ï¼Œæˆ‘ä»¬ä¸èƒ½å¤Ÿåƒæ™®é€šçš„å‡½æ•°é‚£æ ·è°ƒç”¨å®ƒï¼Œå› ä¸ºJavascriptä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Counter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ğŸ”´ React ä¸èƒ½è¿™ä¹ˆåš:</span>
<span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token function">Counter</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<p>åƒè¿™ä¹ˆå†™ä¼šæœ‰é—®é¢˜ã€‚</p>
<hr>
<p>åœ¨æˆ‘ä»¬äº†è§£Reactæ˜¯å¦‚ä½•å¤„ç†è¿™ç±»é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œå¤§å¤šæ•°äººåœ¨ä½¿ç”¨Reactçš„æ—¶å€™ä¼šç”¨åˆ°ç±»ä¼¼äºBabelè¿™æ ·çš„ç¼–è¯‘å·¥å…·ï¼Œä»è€Œèƒ½å¤Ÿåœ¨æ—§çš„æµè§ˆå™¨ä¸Šä½¿ç”¨ç±»ä¼¼äºclassè¿™æ ·çš„è¯­æ³•ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„è®¾è®¡ä¸­è€ƒè™‘åˆ°ç¼–è¯‘å·¥å…·çš„å­˜åœ¨ã€‚</p>
<p>åœ¨ä¸€äº›è€ç‚¹çš„ç‰ˆæœ¬çš„Babelä¸­ï¼Œclassä¸éœ€è¦newä¹Ÿèƒ½å¤Ÿè°ƒç”¨ï¼Œä½†æ˜¯è¿™å½“æ—¶ä¹Ÿæ˜¯å¯ä»¥è§£å†³çš„ - é€šè¿‡æ·»åŠ ä¸€äº›é¢å¤–çš„ä»£ç :</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A bit simplified from Babel output:</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"Cannot call a class as a function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Our code:</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Fred'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… Okay</span>
<span class="token function">Person</span><span class="token punctuation">(</span><span class="token string">'George'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// ğŸ”´ Canâ€™t call class as a function</span></code></pre>
      </div>
<p>ä½ å¯èƒ½å¯ä»¥åœ¨ä½ çš„æ‰“åŒ…åçš„æ–‡ä»¶ä¸­èƒ½å¤Ÿçœ‹åˆ°è¿™äº›ç±»ä¼¼çš„ä»£ç ã€‚å…¶å®è¿™å°±æ˜¯é‚£äº›<code class="language-text">_classCallCheck</code>çš„å‡½æ•°åšçš„äº‹æƒ…ã€‚(ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç–æ¾æ¨¡å¼(loose mode)æ¥é€šè¿‡ä¸æ£€æŸ¥æ¥å‡å°‘æœ€ç»ˆæ‰“åŒ…åçš„åŒ…å¤§å°ï¼Œä½†æ˜¯è¿™å¯èƒ½ä¼šè®©ä½ æƒ³ç”¨ä¸ŠçœŸæ­£çš„classçš„æ—¶å€™å˜å¾—æ›´åŠ å¤æ‚)</p>
<hr>
<p>ç°åœ¨ï¼Œä½ åº”è¯¥èƒ½å¤Ÿæ˜ç™½åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™ä½¿ç”¨<code class="language-text">new</code>å’Œä¸ä½¿ç”¨<code class="language-text">new</code>çš„åŒºåˆ«:</p>
<table>
<thead>
<tr>
<th></th>
<th><code class="language-text">new Person()</code></th>
<th><code class="language-text">Person()</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code class="language-text">class</code></td>
<td>âœ… 
<code class="language-text">this</code>
 æ˜¯ 
<code class="language-text">Person</code>
 çš„å®ä¾‹</td>
<td>ğŸ”´ 
<code class="language-text">TypeError</code></td>
</tr>
<tr>
<td><code class="language-text">function</code></td>
<td>âœ… 
<code class="language-text">this</code>
 æ˜¯ 
<code class="language-text">Person</code>
 å®ä¾‹</td>
<td>ğŸ˜³ 
<code class="language-text">this</code>
 æ˜¯ 
<code class="language-text">window</code>
 æˆ–è€… 
<code class="language-text">undefined</code></td>
</tr>
</tbody>
</table>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ éœ€è¦æ­£ç¡®çš„è°ƒç”¨ä½ çš„ç»„ä»¶ã€‚ <strong>å¦‚æœä½ çš„ç»„ä»¶æ˜¯ä½¿ç”¨classæ¥å®šä¹‰çš„ï¼ŒReactéœ€è¦ä½¿ç”¨<code class="language-text">new</code>æ¥è°ƒç”¨</strong></p>
<p>é‚£ä¹ˆReactæ˜¯æ€ä¹ˆç¡®å®šç»„ä»¶ç©¶ç«Ÿæ˜¯ç±»è¿˜æ˜¯å…¶ä»–çš„ç±»å‹å‘¢?</p>
<p>è¿™æ²¡æœ‰é‚£ä¹ˆç®€å•ï¼å³ä½¿æˆ‘ä»¬æœ¬å°±å¯ä»¥<a href="https://stackoverflow.com/questions/29093396/how-do-you-check-the-difference-between-an-ecmascript-6-class-and-function">åœ¨Javascriptä¸­åŒºåˆ†classå’Œå‡½æ•°</a>ï¼Œä½†æ˜¯è¿™å¯¹é‚£äº›é€šè¿‡ç±»ä¼¼Babaelè¿™æ ·çš„å·¥å…·ç¼–è¯‘çš„classæ²¡ç”¨ï¼Œç¼–è¯‘ä¹‹åè¿™äº›classä¼šå˜æˆä¸€ä¸ªçº¯å‡½æ•°ã€‚Reactè§‰å¾—å¾ˆéš¾ç©å„¿ã€‚</p>
<hr>
<p>OK! é‚£æ˜¯ä¸æ˜¯Reactå¯ä»¥åœ¨æ¯æ¬¡è°ƒç”¨çš„æ—¶å€™éƒ½ä½¿ç”¨<code class="language-text">new</code>ï¼Ÿéå¸¸ä¸å¹¸ï¼Œè¿™ä¹Ÿä¸è¡Œã€‚</p>
<p>åœ¨å‡½æ•°ä¸­ï¼Œä½¿ç”¨<code class="language-text">new</code>æ¥è°ƒç”¨ä¼šåœ¨å†…éƒ¨è¿”å›ä¸€ä¸ª<code class="language-text">this</code>çš„å¯¹è±¡ã€‚è¿™å¯¹æ„é€ å‡½æ•°(æ¯”å¦‚<code class="language-text">Person</code>)ä¼šæ¯”è¾ƒåˆç†ï¼Œä½†æ˜¯å¯¹äºçº¯å‡½æ•°å®šä¹‰çš„ç»„ä»¶è€Œè¨€ï¼Œçœ‹èµ·æ¥å°±å°±ä¼šæ¯”è¾ƒå¥‡æ€ªäº†</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æˆ‘ä»¬ä¸å¸Œæœ›`this`æ˜¯ä»»ä½•å¯¹è±¡</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>è¿™ä¹ˆåšæˆ–è®¸å¯ä»¥å‹‰å¼ºä½¿ç”¨ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æœ‰<em>å…¶ä»–çš„</em>ä¸¤ä¸ªåŸå› è®©æˆ‘ä»¬ä¸ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚</p>
<hr>
<p>æˆ‘ä»¬ä¸èƒ½æ— è„‘ä½¿ç”¨<code class="language-text">new</code>æ“ä½œç¬¦çš„ç¬¬ä¸€ä¸ªåŸå› å°±æ˜¯å¦‚æœå‡½æ•°æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°(ä¸æ˜¯è¢«Babelç¼–è¯‘å‡ºæ¥çš„)ï¼Œä½¿ç”¨<code class="language-text">new</code>æ‰§è¡Œä¹‹åä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼š</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">Greeting</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ”´ Greetingä¸æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°</span></code></pre>
      </div>
<p>è¿™é‡Œæ˜¯æ•…æ„ä½¿ç”¨ç®­å¤´å‡½æ•°çš„ã€‚æ ¹æ®ç®­å¤´å‡½æ•°çš„è®¾è®¡ï¼Œç®­å¤´å‡½æ•°çš„å…¶ä¸­ä¸€ä¸ªä¼˜ç‚¹å°±æ˜¯æˆ‘ä»¬<em>ä¸ç”¨</em>åœ¨æ„è¿™ä¸ªå‡½æ•°è‡ªå·±çš„<code class="language-text">this</code> - å› ä¸ºè¿™ä¸ª<code class="language-text">this</code>æ˜¯æŒ‡å‘æœ€è¿‘çš„æ™®é€šå‡½æ•°çš„<code class="language-text">this</code>:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Friends</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> friends <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>friends<span class="token punctuation">;</span>
    <span class="token keyword">return</span> friends<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>friend <span class="token operator">=></span>
      <span class="token operator">&lt;</span>Friend
        <span class="token comment">// `this`ä¼šä½¿ç”¨`render`å‡½æ•°çš„`this`</span>
        size<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>size<span class="token punctuation">}</span>
        name<span class="token operator">=</span><span class="token punctuation">{</span>friend<span class="token punctuation">.</span>name<span class="token punctuation">}</span>
        key<span class="token operator">=</span><span class="token punctuation">{</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>é‚£ä¹ˆæ‰€ä»¥ <em>ç®­å¤´å‡½æ•°è‡ªå·±æœ¬èº«æ²¡æœ‰<code class="language-text">this</code></em> è¿™å°±æ„å‘³ç€ä»–ä¸å¯èƒ½æˆä¸ºä¸€ä¸ªæ„é€ å‡½æ•°!</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// ğŸ”´ è¿™æ²¡æœ‰ç”¨</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
      </div>
<p>å› æ­¤ï¼Œ<strong>Javascriptä¸å…è®¸ä½¿ç”¨<code class="language-text">new</code>æ¥è°ƒç”¨ç®­å¤´å‡½æ•°</strong> å¦‚æœä½ è¿™ä¹ˆåšï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šå¯¼è‡´ä»£ç å‡ºé—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦æå‰æŠ›å‡ºå¼‚å¸¸ã€‚è¿™å°±å’Œä¹‹å‰æåˆ°çš„ä¸ºä»€ä¹ˆJavascriptä¸èƒ½è®©ä½ åœ¨è°ƒç”¨ç±»çš„æ—¶å€™ä¸ä½¿ç”¨<code class="language-text">new</code>çš„é“ç†ä¸€æ ·ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªå¾ˆåˆç†çš„åšæ³•ï¼Œä½†æ˜¯è¿™è®©æˆ‘ä»¬ä¹‹å‰çš„è®¡åˆ’è½ç©ºã€‚Reactä¸èƒ½è®©æˆ‘ä»¬åœ¨æ‰€æœ‰å‡½æ•°å‰é¢ä½¿ç”¨<code class="language-text">new</code>ï¼Œå› ä¸ºåœ¨ä½¿ç”¨ç®­å¤´å‡½æ•°çš„æ—¶å€™ä¼šå‘ç”ŸæŠ¥é”™ï¼æˆ‘ä»¬åªèƒ½å¤Ÿå°è¯•æ£€æŸ¥ä¸€ä¸ªå‡½æ•°æ˜¯å¦ä¸ºç®­å¤´å‡½æ•°ï¼Œå› ä¸ºç®­å¤´å‡½æ•°æ²¡æœ‰<code class="language-text">prototype</code>ï¼Œå¹¶ä¸”å¯¹è¿™ç±»å‡½æ•°ï¼Œä¸ä½¿ç”¨<code class="language-text">new</code>æ¥è°ƒç”¨:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>prototype <span class="token comment">// undefined</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>prototype <span class="token comment">// {constructor: f}</span></code></pre>
      </div>
<p>ä½†æ˜¯è¿™å¯¹Babelç¼–è¯‘å‡ºæ¥çš„å‡½æ•°<a href="https://github.com/facebook/react/issues/4599#issuecomment-136562930">ä¸èµ·ä½œç”¨</a>ã€‚ä½†æ˜¯è¿™çœ‹èµ·æ¥ä¹Ÿä¸ä¸€å®šæ˜¯ä¸ªå¤§é—®é¢˜(å› ä¸ºæˆ‘ä»¬åº”è¯¥ä¹Ÿä¸ä¼šåœ¨ç®­å¤´å‡½æ•°é‡Œé¢å†™<code class="language-text">this</code>)ï¼Œä½†æ˜¯è¿™é‡Œå¦ä¸€ä¸ªåŸå› è®©æˆ‘ä»¬çš„è¿™ä¸ªæ–¹æ¡ˆå‡ ä¹å®Œè›‹ã€‚</p>
<hr>
<p>å¦ä¸€ä¸ªæˆ‘ä»¬ä¸èƒ½æ— è„‘ä½¿ç”¨<code class="language-text">new</code>æ“ä½œç¬¦çš„åŸå› æ˜¯æˆ‘ä»¬è¿˜éœ€è¦æ’é™¤é‚£äº›Reactæ”¯æŒçš„ç›´æ¥è¿”å›å­—ç¬¦ä¸²æˆ–è€…å…¶ä»–åŸºç¡€ç±»å‹çš„ç»„ä»¶ã€‚</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'Hello'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… 'Hello'</span>
<span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ˜³ Greeting {}</span></code></pre>
      </div>
<p>é¢ã€‚ã€‚ã€‚æˆ‘ä»¬éœ€è¦å†ä¸€æ¬¡çœ‹ä¸€ä¸‹<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new"><code class="language-text">new</code>æ“ä½œç¬¦</a>çš„è®¾è®¡ã€‚æ ¹æ®æˆ‘ä»¬ä¹‹å‰æ‰€çŸ¥é“çš„ï¼Œ<code class="language-text">new</code>å‘Šè¯‰Javascriptå¼•æ“å»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹æ„é€ å‡½æ•°çš„å†…éƒ¨çš„<code class="language-text">this</code>èµ‹å€¼ï¼Œç„¶ååœ¨æœ€åè¿”å›ä¸€ä¸ªå¯¹è±¡ç»™æˆ‘ä»¬ã€‚</p>
<p>ä½†æ˜¯Javascriptä¹Ÿå…è®¸ä¸€ä¸ªä½¿ç”¨<code class="language-text">new</code>è°ƒç”¨çš„å‡½æ•°è¿”å›ä¸€ä¸ªå¦å¤–çš„å¯¹è±¡æ¥è¦†ç›–è¿™ä¸ªå‡½æ•°å†…éƒ¨çš„thisã€‚æƒ³å¿…è¿™æ˜¯ä¸ºäº†è€ƒè™‘è¿™å¯èƒ½å¯¹ç±»ä¼¼é‡ç”¨å¯¹è±¡å®ä¾‹ä¹‹ç±»çš„æ¨¡å¼æ¯”è¾ƒæœ‰ç”¨å§:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// æ‡’åŠ è½½</span>
<span class="token keyword">var</span> zeroVector <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Vector</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>zeroVector <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Reuse the same instance</span>
      <span class="token keyword">return</span> zeroVector<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    zeroVector <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vector</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ˜² b === c</span></code></pre>
      </div>
<p>ä½†æ˜¯ï¼Œå½“ä¸€ä¸ªå‡½æ•°è¿”å›éå¯¹è±¡ç±»å‹çš„å€¼çš„æ—¶å€™ï¼Œ<code class="language-text">new</code>å°±ä¼šæ— è§†è¿™ä¸ªè¿”å›å€¼ã€‚æ¯”å¦‚è¯´å¦‚æœä½ è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°å­—ï¼Œå®ƒå°±ä¼šå½“åšä»€ä¹ˆéƒ½æ²¡æœ‰è¿”å›ã€‚</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Answer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">Answer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… 42</span>
<span class="token keyword">new</span> <span class="token class-name">Answer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ˜³ Answer {}</span></code></pre>
      </div>
<p>å› ä¸ºä½¿ç”¨<code class="language-text">new</code>æ¥è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œè¿”å›ä¸€ä¸ªåŸºæœ¬ç±»å‹(æ¯”å¦‚æ•°å­—æˆ–è€…å­—ç¬¦ä¸²)ä¼šè¢«æ— è§†ã€‚æ‰€ä»¥å¦‚æœReactæ— è„‘ä½¿ç”¨<code class="language-text">new</code>,å°±ä¸èƒ½å¤Ÿæ”¯æŒå“ªäº›ç›´æ¥è¿”å›å­—ç¬¦ä¸²ç±»å‹çš„ç»„å»ºäº†!</p>
<p>è¿™æ˜¾ç„¶å¯¹å¼€å‘è€…æ¥è¯´æ˜¯ä¸å¯æ¥å—çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½åœ¨æ¢ä¸ªæ³•å­ã€‚</p>
<hr>
<p>è‡³ä»Šä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€å…±æ€»ç»“äº†ä»€ä¹ˆï¼ŸReactéœ€è¦åœ¨è°ƒç”¨classï¼ˆåŒ…æ‹¬Babelç¼–è¯‘è¾“å‡ºçš„ï¼‰ä½¿ç”¨<code class="language-text">new</code>æ“ä½œç¬¦ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨æ™®é€šå‡½æ•°æˆ–è€…ç®­å¤´å‡½æ•°çš„æ—¶å€™ä¸ä½¿ç”¨<code class="language-text">new</code>æ“ä½œç¬¦ã€‚è€Œç°åœ¨å¥½åƒè¿˜æ²¡æœ‰ä¸€ä¸ªå¯è¡Œçš„æ–¹æ¡ˆæ¥åŒºåˆ†ä»–ä»¬ã€‚</p>
<p><strong>å¦‚æœæˆ‘ä»¬ä¸èƒ½å¤Ÿè§£å†³æ™®éçš„é—®é¢˜ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°è¯•å»è§£å†³å“ªä¸ªæ¯”è¾ƒç‰¹æ®Šçš„é—®é¢˜å—?</strong></p>
<p>å½“æˆ‘ä»¬ä½¿ç”¨ç±»æ¥å®šä¹‰ç»„å»ºçš„é¥¿æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå»ç»§æ‰¿<code class="language-text">React.Component</code>ï¼Œä¸ºäº†ä½¿ç”¨ä¸€äº›å†…ç½®çš„å‡½æ•°ï¼Œæ¯”å¦‚<code class="language-text">this.setState()</code>ã€‚<strong>æ¢ä¸ªæƒ³æ³•æ¥çœ‹ï¼Œæˆ‘ä»¬å»åŒºåˆ†æ‰€æœ‰çš„ç±»æ— æ³•åšåˆ°çš„è¯ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è€ƒè™‘åªæ£€æŸ¥React.Componentçš„å­ç±»å‘¢</strong></p>
<p>Spoiler: è¿™æ­£å¼Reactåšçš„äº‹æƒ…</p>
<hr>
<p>å½“ç„¶ï¼Œå¸¸ç”¨çš„ç”¨æ¥æ£€æŸ¥<code class="language-text">Greeting</code>æ˜¯å¦æ˜¯Reactç»„ä»¶çš„ç±»çš„å­ç±»çš„æ–¹å¼å°±æ˜¯å–æ£€æŸ¥æ˜¯å¦<code class="language-text">Greeting.prototype</code>æ˜¯å¦æ˜¯React.Componentçš„å®ä¾‹:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">extends</span> <span class="token class-name">A</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">.</span>prototype <span class="token keyword">instanceof</span> <span class="token class-name">A</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre>
      </div>
<p>æˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆï¼Œè¿™æ®µä»£ç çš„è¿è¡Œç»“æœä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·ï¼Ÿï¼ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£JavascriptåŸå‹ã€‚</p>
<p>ä½ å¯èƒ½å¯¹JavascriptåŸå‹é“¾éå¸¸ç†Ÿæ‚‰ã€‚æ¯ä¸ªåœ¨Javascriptä¸­çš„å¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ªåŸå‹ï¼Œå½“æˆ‘ä»¬åœ¨è°ƒç”¨<code class="language-text">gred.sayHi()</code>ä½†æ˜¯<code class="language-text">fred</code>çš„å¯¹è±¡æ²¡æœ‰<code class="language-text">sayHi</code>çš„å±æ€§çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šåœ¨<code class="language-text">fred</code>çš„åŸå‹é“¾ä¸Šå¯»æ‰¾<code class="language-text">sayHi</code>çš„å±æ€§ï¼Œå¦‚æœæˆ‘ä»¬ä¸èƒ½å¤Ÿåœ¨åŸå‹é“¾ä¸Šæ‰¾åˆ°å®ƒï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä¸ªåŸå‹é“¾ä¸Šçš„ä¸‹ä¸€ä¸ªåŸå‹é“¾ï¼ˆ<code class="language-text">fred</code>çš„åŸå‹çš„åŸå‹ï¼‰ï¼Œå°±è¿™ä¹ˆå¾ªç¯æ‰§è¡Œä¸‹å»ã€‚</p>
<p>æˆ‘ä¸æ˜¯åœ¨å¼€ç©ç¬‘...<strong>æœ‰ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ï¼Œä¸€ä¸ªå‡½æ•°æˆ–è€…ç±»çš„<code class="language-text">prototype</code>å±æ€§ <em>å¹¶ä¸</em> æŒ‡å‘è¿™ä¸ªå®ä¾‹çš„<code class="language-text">prototype</code></strong></p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ¤ª Not Person's prototype</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ğŸ˜³ Person's prototype</span></code></pre>
      </div>
<p>æ‰€ä»¥"åŸå‹é“¾"åº”è¯¥æ˜¯ç±»ä¼¼äº<code class="language-text">__proto__.__proto__.__proto__</code>ï¼Œè€Œä¸æ˜¯<code class="language-text">prototype.prototype.prototype</code>ã€‚æˆ‘ä¹Ÿæ˜¯å¾ˆå¤šå¹´æ‰æ˜ç™½è¿™ç‚¹ã€‚</p>
<p>åœ¨ç±»æˆ–è€…å‡½æ•°ä¸Šè®¾ç½®äº†<code class="language-text">prototype</code>, <strong>ä½†æœ€åé€šè¿‡<code class="language-text">new</code>æ“ä½œç¬¦åˆ›å»ºçš„å¯¹è±¡æˆ‘ä»¬æ˜¯é€šè¿‡<code class="language-text">__proto__</code>æ¥è·å–åŸå‹ä¸Šå±æ€§</strong></p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Hi, I am '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> fred <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Fred'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Sets `fred.__proto__` to `Person.prototype`</span></code></pre>
      </div>
<p>Javascriptå°±æ˜¯ä½¿ç”¨<code class="language-text">__proto__</code>é“¾æ¥æŸ¥æ‰¾å±æ€§çš„:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js">fred<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. fredæ˜¯å¦å«æœ‰è¿™ä¸ªsayHiå±æ€§? No.</span>
<span class="token comment">// 2. fred.__proto__ æ˜¯å¦æœ‰ sayHiçš„å±æ€§ ï¼Ÿ æ˜¯çš„. é‚£ä¹ˆå°±è°ƒç”¨å®ƒ!</span>

fred<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 1. fredæ˜¯å¦å«æœ‰è¿™ä¸ªtoStringå±æ€§? No.</span>
<span class="token comment">// 2. fred.__proto__ æ˜¯å¦æœ‰ toStringçš„å±æ€§ ï¼Ÿ No.</span>
<span class="token comment">// 3. fred.__proto__.__proto__ æ˜¯å¦æœ‰ toStringçš„å±æ€§ ï¼Ÿ æ˜¯çš„. é‚£ä¹ˆå°±è°ƒç”¨å®ƒ!</span></code></pre>
      </div>
<p>åœ¨å®é™…ä½¿ç”¨åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½ä¸éœ€è¦è‡ªå·±å»åœ¨ä»£ç ä¸­ç›´æ¥æ¥è§¦<code class="language-text">__proto__</code>ï¼Œé™¤éä½ éœ€è¦å¯¹åŸå‹é“¾ä¸Šç›¸å…³çš„ä¸œè¥¿åšè°ƒè¯•ã€‚å¦‚æœä½ æƒ³è¦è®©æŸä¸ªæˆå‘˜å˜é‡æŒ‚è½½åœ¨<code class="language-text">fred.__proto__</code>ä¸­ï¼Œä½ å¯ä»¥åœ¨<code class="language-text">Person.prototype</code>ä¸­è®¾ç½®è¿™ä¸ªæˆå‘˜å˜é‡ï¼Œè‡³å°‘è¿™æ˜¯JavascriptåŸç”Ÿè®¾è®¡å®šä¹‰ç±»çš„æˆå‘˜å˜é‡çš„æ–¹å¼ã€‚</p>
<p><code class="language-text">__proto__</code>è¿™ä¸ªå±æ€§åœ¨åˆšå¼€å§‹çš„æ—¶å€™åœ¨æµè§ˆå™¨ä¸­ç”šè‡³æ˜¯ä¸è¢«æš´éœ²çš„ï¼Œå› ä¸ºåŸå‹é“¾æ˜¯åº”è¯¥è¢«å½“åšä¸€ä¸ªå†…éƒ¨çš„æ¦‚å¿µã€‚ä½†æ˜¯æœ‰ä¸€äº›æµè§ˆå™¨åŠ ä¸Šäº†<code class="language-text">__proto__</code>ï¼Œæ‰€ä»¥æœ€åæˆä¸ºäº†ä¸€ç§æ ‡å‡†(è™½ç„¶æœ€åè¿˜æ˜¯è¢«<code class="language-text">Object.getPrototypeOf()</code>ä»£æ›¿äº†)ã€‚</p>
<p><strong>ä½†æ˜¯è‡³ä»Šå…³äºä¸€ä¸ªç±»çš„prototypeçš„å±æ€§åœ¨ä»–çš„å®ä¾‹ä¸Šï¼Œå¹¶ä¸æ˜¯å«åšprototypeè¿™ä¸ªé—®é¢˜ä¾ç„¶è®©æˆ‘å¾ˆç–‘æƒ‘</strong>ï¼ˆæ¯”å¦‚ï¼Œ<code class="language-text">fred.prototype</code>æ˜¯æœªå®šä¹‰ï¼Œå› ä¸º<code class="language-text">fred</code>ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰ã€‚ä¸ªäººæ¥è¯´ï¼Œæˆ‘è§‰å¾—è¿™æ˜¯é€ æˆä¸€ä¸ªJavascriptå¼€å‘è€…åœ¨åŸå‹é“¾ä¸Šæ¯”è¾ƒå®¹æ˜“æé”™çš„åœ°æ–¹ï¼Œå³ä½¿æ˜¯éå¸¸æœ‰ç»éªŒçš„å¼€å‘è€…ã€‚</p>
<hr>
<p>è¿™æ˜¯ä¸€ç¯‡æ¯”è¾ƒé•¿çš„æ–‡ç« ï¼Œé¢ã€‚æˆ‘å…¶å®æƒ³è¯´ï¼Œå·²ç»å¿«è¯»åˆ°80%äº†ï¼Œåˆ«æ”¾å¼ƒã€‚</p>
<p>æˆ‘ä»¬éƒ½æ˜ç™½å½“æˆ‘ä»¬ä½¿ç”¨<code class="language-text">obj.foo</code>çš„æ—¶å€™ï¼ŒJavascriptå…¶å®æ˜¯åœ¨ä¾æ¬¡å¯»æ‰¾<code class="language-text">obj</code>ä¸Šçš„<code class="language-text">foo</code>ã€<code class="language-text">obj.__proto__.foo</code>ã€<code class="language-text">obj.__proto__.__proto__.foo</code> ç­‰ç­‰</p>
<p>åˆ©ç”¨classï¼Œä½ å¯èƒ½ä¸éœ€è¦çŸ¥é“è¿™äº›æœºåˆ¶ï¼Œä½†æ˜¯ç»§æ‰¿ä¹Ÿæ˜¯åŸºäºè¿™ä¸ªåŸå‹é“¾çš„ã€‚è¿™ä¹Ÿå°±æ˜¯Reactçš„ç±»çš„å®ä¾‹æ˜¯å¦‚ä½•è·å–åˆ°ç±»ä¼¼<code class="language-text">setState</code>çš„çˆ¶ç±»å‡½æ•°çš„:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Greeting.prototype</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// React.Component.prototype</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Object.prototype</span>

c<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// æ‰¾åˆ° c.__proto__ (Greeting.prototype)</span>
c<span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ‰¾åˆ° c.__proto__.__proto__ (React.Component.prototype)</span>
c<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ‰¾åˆ° c.__proto__.__proto__.__proto__ (Object.prototype)</span></code></pre>
      </div>
<p>æ¢å¥è¯æ¥è¯´ï¼Œ<strong>å½“ä½ ä½¿ç”¨ç±»çš„æ—¶å€™ï¼Œä¼šè¿™ä¸ªå®ä¾‹çš„<code class="language-text">__proto__</code>é“¾æ¥æ¨¡æ‹Ÿç±»çš„ç»§æ‰¿</strong></p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// ç»§æ‰¿é“¾</span>
Greeting
  â†’ React<span class="token punctuation">.</span>Component
    â†’ <span class="token function">Object</span> <span class="token punctuation">(</span>implicitly<span class="token punctuation">)</span>

<span class="token comment">// åŸå‹é“¾</span>
<span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  â†’ Greeting<span class="token punctuation">.</span>prototype
    â†’ React<span class="token punctuation">.</span>Component<span class="token punctuation">.</span>prototype
      â†’ Object<span class="token punctuation">.</span>prototype</code></pre>
      </div>
<p>å¦‚ä¸Šçš„ä¸¤ä¸ªé“¾</p>
<hr>
<p>å› ä¸ºæˆ‘ä»¬æ˜¯ä½¿ç”¨<code class="language-text">__proto__</code>æ¥æ¨¡æ‹Ÿç±»çš„ç»§æ‰¿ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç‚¹æ¥ç¡®å®š<code class="language-text">Greeting</code>æ˜¯å¦ç»§æ‰¿äº<code class="language-text">React.Component</code>ã€‚æˆ‘ä»¬å¯ä»¥é¡ºç€<code class="language-text">__proto__</code>é“¾æ¥æ£€æŸ¥ã€‚</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// `__proto__` é“¾</span>
<span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  â†’ Greeting<span class="token punctuation">.</span>prototype <span class="token comment">// ğŸ•µï¸ æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹</span>
    â†’ React<span class="token punctuation">.</span>Component<span class="token punctuation">.</span>prototype <span class="token comment">// âœ… æ‰¾åˆ°äº†!</span>
      â†’ Object<span class="token punctuation">.</span>prototype</code></pre>
      </div>
<p>é¡ºä¾¿ä¸€æï¼Œ<code class="language-text">x</code>ç»§æ‰¿äº<code class="language-text">y</code>å…¶å®ä¹Ÿæ˜¯ä¾ç…§è¿™ç§æ–¹å¼ï¼Œå®ƒé€šè¿‡å¯»æ‰¾<code class="language-text">x.__proto__</code>çš„é“¾æ¥å¯»æ‰¾æ˜¯å¦å­˜åœ¨<code class="language-text">Y.prototype</code>ã€‚</p>
<p>æ­£å¸¸æ¥è¯´ï¼Œè¿™æœ¬æ¥æ˜¯ç”¨æ¥ç¡®å®šæŸä¸ªå®ä¾‹æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å®ä¾‹çš„:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token keyword">let</span> greeting <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeting <span class="token keyword">instanceof</span> <span class="token class-name">Greeting</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// greeting (ğŸ•µï¸â€ æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹)</span>
<span class="token comment">//   .__proto__ â†’ Greeting.prototype (âœ… æ‰¾åˆ°äº†!)</span>
<span class="token comment">//     .__proto__ â†’ React.Component.prototype </span>
<span class="token comment">//       .__proto__ â†’ Object.prototype</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeting <span class="token keyword">instanceof</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// greeting (ğŸ•µï¸â€ æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹å¯»æ‰¾)</span>
<span class="token comment">//   .__proto__ â†’ Greeting.prototype</span>
<span class="token comment">//     .__proto__ â†’ React.Component.prototype (âœ… æ‰¾åˆ°äº†!)</span>
<span class="token comment">//       .__proto__ â†’ Object.prototype</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeting <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token comment">// greeting (ğŸ•µï¸â€ æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹å¯»æ‰¾)</span>
<span class="token comment">//   .__proto__ â†’ Greeting.prototype</span>
<span class="token comment">//     .__proto__ â†’ React.Component.prototype</span>
<span class="token comment">//       .__proto__ â†’ Object.prototype (âœ… æ‰¾åˆ°äº†!)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeting <span class="token keyword">instanceof</span> <span class="token class-name">Banana</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
<span class="token comment">// greeting (ğŸ•µï¸â€ æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹æŸ¥æ‰¾)</span>
<span class="token comment">//   .__proto__ â†’ Greeting.prototype</span>
<span class="token comment">//     .__proto__ â†’ React.Component.prototype </span>
<span class="token comment">//       .__proto__ â†’ Object.prototype (ğŸ™…â€ æ²¡æœ‰æ‰¾åˆ°!)</span></code></pre>
      </div>
<p>è€Œä¸”è¿™ä¹Ÿå¯¹ç¡®å®šä¸€ä¸ªç±»æ˜¯å¦æ˜¯å¦ä¸€ä¸ªç±»çš„å­ç±»æœ‰ç”¨:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Greeting<span class="token punctuation">.</span>prototype <span class="token keyword">instanceof</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// greeting</span>
<span class="token comment">//   .__proto__ â†’ Greeting.prototype (ğŸ•µï¸â€ æˆ‘ä»¬ä»è¿™é‡Œå¼€å§‹æŸ¥æ‰¾)</span>
<span class="token comment">//     .__proto__ â†’ React.Component.prototype (âœ… æ‰¾åˆ°äº†!)</span>
<span class="token comment">//       .__proto__ â†’ Object.prototype</span></code></pre>
      </div>
<p>è¿™ä¸ªæ£€æŸ¥æ–¹å¼å°±èƒ½ç¡®å®šä¸€ä¸ªç»„ä»¶æ˜¯React.Componentçš„å­ç±»è¿˜æ˜¯æ™®é€šå‡½æ•°</p>
<hr>
<p>ç„¶è€Œè¿™å…¶å®å¹¶ä¸æ˜¯ReactçœŸå®çš„å®ç°ã€‚ã€‚ã€‚ğŸ˜³</p>
<p>å¦ä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•å°±æ˜¯å»æ£€æŸ¥åŸå‹ä¸­æ˜¯å¦å­˜åœ¨<code class="language-text">render</code>å‡½æ•°ï¼Œä½†æ˜¯å½“æ—¶å¹¶<a href="https://github.com/facebook/react/issues/4599#issuecomment-129714112">ä¸èƒ½ç¡®å®š</a>Reactçš„ç»„ä»¶APIå°†æ¥ä¼šå¦‚ä½•å‘å±•çš„ã€‚æ¯ä¸€ç§æ£€æŸ¥æ–¹å¼éƒ½ä¼šæœ‰å®ƒä¸åˆé€‚çš„åœ°æ–¹ã€‚ç°åœ¨è¿™ç§æ£€æŸ¥çš„æ–¹å¼å½“<code class="language-text">render</code>è¢«å®šä¹‰æˆå½“å‰å®ä¾‹çš„å‡½æ•°çš„æ—¶å€™å°±ä¼šä¸è¡Œäº†ï¼Œæ¯”å¦‚å®šä¹‰åœ¨ç±»çš„æˆå‘˜å˜é‡ä¸Šã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸ºäº†é˜²æ­¢ä¸Šé¢çš„é—®é¢˜ï¼ŒReact <a href="https://github.com/facebook/react/pull/4663">æ·»åŠ äº†</a> ä¸€ä¸ªç‰¹æ®Šçš„æ ‡å¿—åœ¨ç»„ä»¶çš„åŸºç¡€çˆ¶ç±»ä¸Šã€‚Reactä¼šæ£€æŸ¥è¿™ä¸ªæ ‡å¿—æ˜¯å¦å­˜åœ¨ï¼Œè¿™å°±æ˜¯Reactä¸ºä»€ä¹ˆä¼šçŸ¥é“ä¸€ä¸ªç»„ä»¶æ˜¯Reactç»„ä»¶è¿˜æ˜¯æ™®é€šçš„å‡½æ•°ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªæ ‡å¿—è¢«å®šä¹‰åœ¨<code class="language-text">React.Component</code>ç±»é‡Œ:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// Reactå†…éƒ¨</span>
<span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Component<span class="token punctuation">.</span>isReactClass <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æˆ‘å¯ä»¥åƒè¿™æ ·æ£€æŸ¥</span>
<span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Greeting<span class="token punctuation">.</span>isReactClass<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… å¯¹çš„</span></code></pre>
      </div>
<p>ä½†æ˜¯ï¼Œæœ‰äº›ç±»çš„å®ç°ä¸­<a href="https://github.com/scala-js/scala-js/issues/1900">æ²¡æœ‰</a>ç»§æ‰¿é™æ€çš„å±æ€§ï¼ˆæˆ–è€…ä¸è§„èŒƒçš„è®¾ç½®äº†<code class="language-text">__proto__</code>ï¼‰ï¼Œç„¶åæ ‡å¿—å°±è¢«ä¸¢å¤±äº†ã€‚</p>
<p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåæ¥ React <a href="https://github.com/facebook/react/pull/5021">ç§»åŠ¨</a>äº†æ ‡å¿—åˆ°äº†<code class="language-text">React.Component.prototype</code>:</p>
<div class="gatsby-highlight" data-language="js">
      <pre class="language-js"><code class="language-js"><span class="token comment">// Reactå†…éƒ¨</span>
<span class="token keyword">class</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Component<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>isReactComponent <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æˆ‘ä»¬å¯ä»¥çœ‹çœ‹æ˜¯å¦æ˜¯è¿™æ ·çš„</span>
<span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Greeting<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>isReactComponent<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// âœ… Yes</span></code></pre>
      </div>
<p><strong>é¡¾åæ€ä¹‰ï¼Œè¿™ä¸ªå˜é‡å</strong></p>
<p>ä½ å¯èƒ½ä¼šæƒ³ï¼Œä¸ºä»€ä¹ˆè¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªboolå€¼ï¼Œè¿™åœ¨å¼€å‘ä½¿ç”¨ä¸­æ— ä¼¤å¤§é›…ï¼Œä½†æ˜¯åœ¨æœ€è¿‘çš„å‡ ä¸ªJestç‰ˆæœ¬ä¸­(é‚£æ—¶å€™Jestè¿˜ä¸æ˜¯å¾ˆå¥½ç”¨)é»˜è®¤æ‰“å¼€äº†è‡ªåŠ¨mockã€‚å®ƒçœç•¥äº†mockåŸºæœ¬æ•°æ®ï¼Œ<a href="https://github.com/facebook/react/pull/4663#issuecomment-136533373">ä½¿å¾—Reactçš„checkå¤±æ•ˆäº†</a>ï¼Œè°¢è°¢Jest</p>
<p>è¿™ä¸ª<code class="language-text">isReactComponent</code>çš„æ ‡è¯†è‡³ä»Šéƒ½è¿˜åœ¨<a href="https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/react-reconciler/src/ReactFiber.js#L297-L300">Reactä¸­ä½¿ç”¨</a></p>
<p>å¦‚æœä½ ä¸ç»§æ‰¿<code class="language-text">React.Component</code>ï¼ŒReactä¸èƒ½åœ¨åŸå‹é“¾ä¸Šæ‰¾åˆ°<code class="language-text">isReactComponent</code>è¿™ä¸ªæ ‡å¿—ï¼Œæ‰€ä»¥Reactä¸ä¼šæŠŠè¿™ä¸ªç±»å½“åšä¸€ä¸ªç±»æ¥çœ‹ï¼Œç°åœ¨ä½ å°±èƒ½æ˜ç™½<a href="https://stackoverflow.com/a/42680526/458193">æœ€é¢‘ç¹çš„é—®é¢˜</a> - åƒ<code class="language-text">Cannot call a class a function</code>çš„é”™è¯¯éœ€è¦é€šè¿‡ç»§æ‰¿React.Componentè§£å†³ã€‚æœ€åï¼Œå¦‚æœä½ çš„ç»„ä»¶çš„åŸå‹ä¸Šæœ‰<code class="language-text">render</code>å‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰<code class="language-text">isReactComponent</code>ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œä¼šæŠ›å‡ºä¸€ä¸ª<a href="https://github.com/facebook/react/pull/11168">è­¦å‘Š</a>ã€‚</p>
<hr>
<p>ä½ å¯èƒ½è§‰å¾—è¿™ç¯‡æ–‡ç« æ€»æ˜¯åœ¨ç”¨ä¸€ç§åŠèƒƒå£çš„æ–¹å¼åœ¨å¼•å¯¼ä½ å‘ä¸‹é˜…è¯»ã€‚<strong>æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆéå¸¸ç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬èŠ±äº†å¤§ç¯‡å¹…æ¥è§£é‡Š<em>ä¸ºä»€ä¹ˆ</em>Reactæœ€ç»ˆä¼šä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆä»¥åŠè¿˜æœ‰ä»€ä¹ˆå…¶ä»–çš„é€‰æ‹©</strong></p>
<p>ä»¥æˆ‘çš„ç»éªŒæ¥çœ‹ï¼Œè¿™å¯¹äºä¸€ä¸ªåº“çš„APIæ¥è¯´æ˜¯ä¸€ä»¶éå¸¸æ­£å¸¸çš„äº‹æƒ…ã€‚ä¸ºäº†è®©ä¸€ä¸ªAPIèƒ½å¤Ÿæ›´ç®€å•çš„è¢«ä½¿ç”¨ï¼Œä½ æ€»æ˜¯éœ€è¦è€ƒè™‘è¯­è¨€(å¦‚æœå¯èƒ½çš„è¯ï¼Œå¯ä»¥è€ƒè™‘å¤šç§è¯­è¨€æˆ–è€…è¯­è¨€çš„æœªæ¥)ï¼Œè¿è¡Œæ—¶æ€§èƒ½ï¼Œç¼–è¯‘æ—¶æˆ–è€…å…¶ä»–çš„ç”¨æˆ·ä½“éªŒï¼Œç”Ÿæ€ç³»ç»Ÿçš„æƒ…å†µï¼Œæ‰“åŒ…çš„è§£å†³æ–¹æ¡ˆæŒ‰ï¼Œæ›´å°‘çš„è­¦å‘Šç­‰ç­‰ã€‚å¯èƒ½æœ€åçš„è§£å†³æ–¹æ¡ˆå¹¶ä¸ä¼šæ€»æ˜¯é‚£ä¹ˆä¼˜é›…ï¼Œä½†æ˜¯ä¸€å®šè¦éå¸¸å®ç”¨ã€‚</p>
<p><strong>å¦‚æœä¸€ä¸ªAPIæ˜¯æˆåŠŸçš„ï¼Œé‚£ä¹ˆ<em>ä»–çš„ä½¿ç”¨è€…</em>å®Œå…¨ä¸éœ€è¦å…³å¿ƒè¿™ä¸ªAPIå†…éƒ¨æ˜¯å¦‚ä½•è¿è¡Œçš„</strong>ï¼Œä»–ä»¬åªéœ€è¦å…³å¿ƒå¦‚ä½•åšè‡ªå·±çš„åº”ç”¨å°±å¯ä»¥äº†</p>
<p>å¦‚æœä½ æ€»æ˜¯ä¿æŒå¥½å¥‡å¿ƒï¼Œä½ ä¼šè§‰å¾—çŸ¥é“Reactçš„è¿™äº›å†…å¹•ä¼šéå¸¸å¼€å¿ƒã€‚</p></div></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-3753e803ea1a9abe3edc.js","261085952541737":"component---src-pages-posts-js-cd1847220dc74c22455a.js","195351340454287":"component---src-templates-post-js-151fda6e99914a23c475.js","162898551421021":"component---src-pages-404-js-be0b53f9f29efb807651.js","35783957827783":"component---src-pages-index-js-75c9bfdbc5a000fa0746.js","60335399758886":"path----372f0b900649fbdd2150.js","52128937219153":"path---posts-é™å¿ƒæ‰“ç£¨æ‰‹ä¸­åˆ©åˆƒ-17ad9d900d78d587c2b4.js","155720654889932":"path---posts-node-a7f1f252c500bb49e88f.js","108919453860541":"path---posts-docker-f43dde7b4254d49ff2a3.js","216240011187204":"path---posts-promise-bfd9096e6b2d351edfde.js","252992580755484":"path---posts-es-e9e0d0dfe1ab32498f2e.js","34712125554247":"path---posts-react-4f84403e6f24dfec5c2d.js","146831492438712":"path---posts-redux-3b800fddaef8c2bcb6bd.js","188259988993670":"path---posts-webpack-eba839e869b614fc5d5f.js","155243275344959":"path---posts-wepy-88cf11c1a9cf9d0e8900.js","259481028934733":"path---posts-å°ç¨‹åº-ca862660c157ecc02ca0.js","202390707485127":"path---posts-translate-6fb411e23f5102908082.js","29362442043640":"path---posts-overreacted-ed8ab5b002f7af96b0f5.js","107370358937462":"path---posts-calm-to-polish-sword-express-fcbe0b2de030d6cc6c98.js","173402839352015":"path---posts-calm-to-polish-sword-ghost-to-passport-89e7ee61784af9f15ea5.js","162685832501665":"path---posts-docker-my-fontend-project-5eef77d637a9e4428a75.js","236054049938401":"path---posts-read-code-es-promise-polyfill-c056fe667c471ad927aa.js","270194815372944":"path---posts-read-react-redux-efaa77f3fc3f05a0d5b2.js","54342248932196":"path---posts-settle-react-es-6-119dbaf4693d20879a2f.js","164086441910093":"path---posts-shallow-into-wepy-source-code-598d7888a1449b7c2ba6.js","9756229565306":"path---posts-translate-overreacted-how-does-react-tell-a-class-from-a-function-1605e86aeffe6e303109.js","99838320125203":"path---posts-translate-overreacted-why-do-react-elements-have-typeof-property-ec5c99a70765b50265b0.js","60536836248096":"path---posts-translate-overreacted-why-do-we-write-super-props-34c121dcd6ed048ce90e.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-a0e39f21c11f6a62c5ab.js","140933230050240":"path---posts-5d689ab557cef6b83626.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-5fa57a956833cc6431c9.js"}/*]]>*/</script><script>/*<![CDATA[*/["/commons-cf32f37b11eea4693204.js","/app-3753e803ea1a9abe3edc.js","/path---posts-translate-overreacted-how-does-react-tell-a-class-from-a-function-1605e86aeffe6e303109.js","/component---src-templates-post-js-151fda6e99914a23c475.js","/component---src-layouts-index-js-5fa57a956833cc6431c9.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>